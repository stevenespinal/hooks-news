(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{39:function(e,t,a){e.exports=a(87)},44:function(e,t,a){},87:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(35),o=a.n(c),s=(a(44),a(7)),i=a(4),l=a(2),u=a.n(l),m=a(6),d=a(17),p=a(12),f=a(3),h=function(e,t,a){var r=Object(n.useState)(e),c=Object(f.a)(r,2),o=c[0],s=c[1],i=Object(n.useState)({}),l=Object(f.a)(i,2),u=l[0],m=l[1],h=Object(n.useState)(!1),b=Object(f.a)(h,2),v=b[0],E=b[1];Object(n.useEffect)(function(){v&&(0===Object.keys(u).length?(a(),E(!1)):E(!1))},[u]);return{handleChange:function(e){var t=e.target,a=t.name,n=t.value;s(function(e){return Object(p.a)({},e,Object(d.a)({},a,n))})},handleSubmit:function(e){e.preventDefault();var a=t(o);m(a),E(!0)},values:o,handleBlur:function(){var e=t(o);m(e)},isSubmitting:v,errors:u}};function b(e){var t={};return e.description?e.description.length<10&&(t.description="Description must be at least 10 characters."):t.description="Description required.",e.url?/^(ftp|http|https):\/\/[^ "]+$/.test(e.url)||(t.url="Url not valid."):t.url="Url required.",t}var v=Object(n.createContext)(null),E={description:"",url:""},g=function(e){var t=e.history,a=Object(n.useContext)(v),c=a.firebase,o=a.currentUser,s=h(E,b,function(){return f.apply(this,arguments)}),i=s.handleSubmit,l=s.handleChange,d=s.values,p=s.errors;function f(){return(f=Object(m.a)(u.a.mark(function e(){var a,n,r;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=4;break}t.push("/login"),e.next=9;break;case 4:return a=d.url,n=d.description,r={url:a,description:n,postedBy:{id:o.uid,name:o.displayName},votes:[],voteCount:0,comments:[],created:Date.now()},e.next=8,c.db.collection("links").add(r);case 8:t.push("/");case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}return r.a.createElement("form",{onSubmit:i,className:"flex flex-column mt3"},r.a.createElement("input",{className:p.description&&"errors-input",onChange:l,value:d.description,type:"text",name:"description",placeholder:"Description for link",autoComplete:"off"}),p.description&&r.a.createElement("p",{className:"error-text"},p.description),r.a.createElement("input",{className:p.url&&"errors-input",onChange:l,value:d.url,type:"url",name:"url",placeholder:"Url for link",autoComplete:"off"}),p.url&&r.a.createElement("p",{className:"error-text"},p.url),r.a.createElement("button",{className:"button",type:"submit"},"Submit"))},w=function(e){var t={};return e.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(e.email)||(t.email="Invalid email address."):t.email="Email required.",e.password?e.password.length<6&&(t.password="Password must be at least 6 characters."):t.password="Password required.",t},O=a(36),j={apiKey:"AIzaSyAUVSjfeGZ_GpYauPlwyhXCHeO5Ssj8mzc",authDomain:"hooks-news-c9337.firebaseapp.com",databaseURL:"https://hooks-news-c9337.firebaseio.com",projectId:"hooks-news-c9337",storageBucket:"hooks-news-c9337.appspot.com",messagingSenderId:"814372366223",appId:"1:814372366223:web:10d6f21ccea29777f9cdfa"},k=a(20),x=a.n(k),N=(a(47),a(49),new function e(){var t=this;Object(O.a)(this,e),this.register=function(){var e=Object(m.a)(u.a.mark(function e(a,n,r){var c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.auth.createUserWithEmailAndPassword(n,r);case 2:return c=e.sent,e.next=5,c.user.updateProfile({displayName:a});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),this.login=function(){var e=Object(m.a)(u.a.mark(function e(a,n){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.auth.signInWithEmailAndPassword(a,n));case 1:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),this.logout=Object(m.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.auth.signOut();case 2:case"end":return e.stop()}},e)})),this.resetPassword=function(){var e=Object(m.a)(u.a.mark(function e(a){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.auth.sendPasswordResetEmail(a);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),x.a.initializeApp(j),this.auth=x.a.auth(),this.db=x.a.firestore()}),y={name:"",email:"",password:""},C=function(e){var t=e.history,a=Object(n.useState)(!0),c=Object(f.a)(a,2),o=c[0],i=c[1],l=Object(n.useState)(null),d=Object(f.a)(l,2),p=d[0],b=d[1],v=h(y,w,function(){var e=Object(m.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!o){e.next=6;break}return e.next=4,N.login(S,B);case 4:e.next=8;break;case 6:return e.next=8,N.register(C,S,B);case 8:t.push("/"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Authentication error.",e.t0),b(e.t0.message);case 15:case"end":return e.stop()}},e,null,[[0,11]])}));return function(){return e.apply(this,arguments)}}()),E=v.handleChange,g=v.handleSubmit,O=v.values,j=v.handleBlur,k=v.isSubmitting,x=v.errors,C=O.name,S=O.email,B=O.password;return r.a.createElement("div",null,r.a.createElement("h2",{className:"mv3"},o?"Sign In":"Create an account"),r.a.createElement("form",{onSubmit:g,className:"flex flex-column"},!o&&r.a.createElement("input",{name:"name",value:C,type:"text",placeholder:"Your Name",autoComplete:"off",onChange:E}),r.a.createElement("input",{className:x.email&&"error-input",name:"email",onBlur:j,value:S,type:"email",placeholder:"Email Address",autoComplete:"off",onChange:E}),x.email&&r.a.createElement("p",{className:"error-text"},x.email),r.a.createElement("input",{className:x.password&&"error-input",name:"password",onBlur:j,value:B,type:"password",placeholder:o?"Enter your password":"Choose a secure password",onChange:E}),x.password&&r.a.createElement("p",{className:"error-text"},x.password),p&&r.a.createElement("p",{className:"error-text"},p),r.a.createElement("div",{className:"flex mt3"},r.a.createElement("button",{type:"submit",className:"button pointer mr2",disabled:k,style:{backgroundColor:k?"grey":"orange"}},"Submit"),r.a.createElement("button",{type:"button",className:"button pointer",onClick:function(){return i(function(e){return!e})}},o?"Need to create an account?":"Already Have an Account?"))),r.a.createElement("div",{className:"forgot-password"},r.a.createElement(s.b,{to:"/forgot"},"Forgot Password?")))};var S=function(){var e=Object(n.useContext)(v).firebase,t=Object(n.useState)(""),a=Object(f.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(!1),i=Object(f.a)(s,2),l=i[0],d=i[1],p=Object(n.useState)(null),h=Object(f.a)(p,2),b=h[0],E=h[1],g=function(){var t=Object(m.a)(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.resetPassword(c);case 3:d(!0),E(null),t.next=12;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error sending email.",t.t0),d(!1),E(t.t0.message);case 12:case"end":return t.stop()}},t,null,[[0,7]])}));return function(){return t.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement("input",{type:"email",className:"input",placeholder:"Provide your account email",onChange:function(e){return o(e.target.value)}}),r.a.createElement("div",null,r.a.createElement("button",{className:"button",onClick:g},"Reset Password")),l&&r.a.createElement("p",null,"Check your email to reset password"),b&&r.a.createElement("p",{className:"error-text"},b))},B=a(19),A=5;var P=a(18),D=a.n(P);var I=Object(i.g)(function(e){var t=e.link,a=e.index,c=e.showCount,o=e.history,i=Object(n.useContext)(v),l=i.firebase,d=i.currentUser,p=d&&d.uid===t.postedBy.id,f=function(){var e=Object(m.a)(u.a.mark(function e(){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.db.collection("links").doc(t.id),e.prev=1,e.next=4,a.delete();case 4:console.log("Document with ID:  ".concat(t.id," deleted.")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error("Error deleting document",e.t0);case 10:case"end":return e.stop()}},e,null,[[1,7]])}));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"flex items-start mt2"},r.a.createElement("div",{className:"flex items-center"},c&&r.a.createElement("span",{className:"gray"},a),r.a.createElement("div",{className:"vote-button",onClick:function(){if(d){var e=l.db.collection("links").doc(t.id);e.get().then(function(){var t=Object(m.a)(u.a.mark(function t(a){var n,r,c,o;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a.exists){t.next=7;break}return n=a.data().votes,r={votedBy:d.uid,name:d.displayName},c=[].concat(Object(B.a)(n),[r]),o=c.length,t.next=7,e.update({votes:c,voteCount:o});case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}else o.push("/login")}},"\u25b2")),r.a.createElement("div",{className:"ml1"},r.a.createElement("div",null,r.a.createElement("a",{className:"black",href:t.url,target:"_blank",rel:"noopener noreferrer"},t.description," "),r.a.createElement("span",{className:"link"},"(",t.url.replace(/^https?:\/\//i,""),")")),r.a.createElement("div",{className:"f6 lh-copy gray"},t.voteCount," Votes By ",t.postedBy.name," ",D()(t.created)," ago | ",r.a.createElement(s.b,{to:"/link/".concat(t.id)},t.comments.length>0?"".concat(t.comments.length," comments"):"Discuss"),p&&r.a.createElement(r.a.Fragment,null," | ",r.a.createElement("span",{className:"delete-button",onClick:f},"Delete")))))});var U=function(){var e=Object(n.useState)(""),t=Object(f.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),s=Object(f.a)(o,2),i=s[0],l=s[1],u=Object(n.useState)([]),m=Object(f.a)(u,2),d=m[0],h=m[1],b=Object(n.useContext)(v).firebase;Object(n.useEffect)(function(){E()},[]);var E=function(){b.db.collection("links").get().then(function(e){var t=e.docs.map(function(e){return Object(p.a)({id:e.id},e.data())});l(t)})};return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t=a.toLowerCase(),n=i.filter(function(e){return e.description.toLowerCase().includes(t)||e.url.toLowerCase().includes(t)||e.postedBy.name.toLowerCase().includes(t)});h(n)}},r.a.createElement("div",null,"Search ",r.a.createElement("input",{type:"text",onChange:function(e){return c(e.target.value)}}),r.a.createElement("button",{type:"submit"},"OK"))),d.map(function(e,t){return r.a.createElement(I,{link:e,index:t,key:e.id,showCount:!1})}))},L=a(38),q=a.n(L);var F=function(e){var t=e.location,a=e.match,c=e.history,o=Object(n.useContext)(v).firebase,s=Object(n.useState)([]),i=Object(f.a)(s,2),l=i[0],u=i[1],m=Object(n.useState)(null),d=Object(f.a)(m,2),h=d[0],b=d[1],E=Number(a.params.page),g=t.pathname.includes("new"),w=t.pathname.includes("top"),O=Object(n.useState)(!1),j=Object(f.a)(O,2),k=j[0],x=j[1],N=o.db.collection("links");function y(e){var t=e.docs.map(function(e){return Object(p.a)({id:e.id},e.data())}),a=t[t.length-1];u(t),b(a),x(!1)}Object(n.useEffect)(function(){var e=function(){var e=Boolean(h);if(x(!0),w)return N.orderBy("voteCount","desc").limit(A).onSnapshot(y);if(1===E)return N.orderBy("created","desc").limit(A).onSnapshot(y);if(e)return N.orderBy("created","desc").startAfter(h.created).limit(A).onSnapshot(y);var t=E*A-A;return q.a.get("https://us-central1-hooks-news-c9337.cloudfunctions.net/linksPagination?offset=".concat(t)).then(function(e){var t=e.data,a=t[t.length-1];u(t),b(a),x(!1)}),function(){}}();return function(){return e()}},[w,E]);var C=E?(E-1)*A+1:1;return r.a.createElement("div",{style:{opacity:k?.25:1}},l.map(function(e,t){return r.a.createElement(I,{key:e.id,showCount:!0,link:e,index:t+C})}),g&&r.a.createElement("div",{className:"pagination"},r.a.createElement("div",{className:"pointer mr2",onClick:function(){E>1&&c.push("/new/".concat(E-1))}},"Previous"),r.a.createElement("div",{className:"pointer",onClick:function(){E<=l.length/A&&c.push("/new/".concat(E+1))}},"Next")))};var H=function(e){var t=Object(n.useContext)(v),a=t.firebase,c=t.currentUser,o=Object(n.useState)(null),s=Object(f.a)(o,2),i=s[0],l=s[1],d=e.match.params.linkId,h=a.db.collection("links").doc(d),b=Object(n.useState)(""),E=Object(f.a)(b,2),g=E[0],w=E[1];Object(n.useEffect)(function(){O()},[]);var O=function(){h.get().then(function(e){l(Object(p.a)({},e.data(),{id:e.id}))})},j=function(){var t=Object(m.a)(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c?h.get().then(function(e){if(e.exists){var t=e.data().comments,a={postedBy:{id:c.uid,name:c.displayName},created:Date.now(),text:g},n=[].concat(Object(B.a)(t),[a]);h.update({comments:n}),l(function(e){return Object(p.a)({},e,{comments:n})}),w("")}}):e.history.push("/login");case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();return i?r.a.createElement("div",null,r.a.createElement(I,{link:i,showCount:!1}),r.a.createElement("textarea",{onChange:function(e){return w(e.target.value)},value:g,name:"",id:"",cols:"60",rows:"6"}),r.a.createElement("div",{className:"button",onClick:j},"Add Comment"),i.comments.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("p",{className:"comment-author"},e.postedBy.name," | ",D()(e.created)," ago"),r.a.createElement("p",null,e.text))})):r.a.createElement("div",null,"Loading . . .")},W=Object(i.g)(function(){var e=Object(n.useContext)(v),t=e.currentUser,a=e.firebase;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"flex"},r.a.createElement("img",{src:"/logo.png",alt:"Hooks News Logo",className:"logo"}),r.a.createElement(s.c,{to:"/",className:"header-title"},"Hooks News"),r.a.createElement(s.c,{to:"/",className:"header-link"},"New"),r.a.createElement("div",{className:"divider"}," |"),r.a.createElement(s.c,{className:"header-link",to:"/top"},"Top"),r.a.createElement("div",{className:"divider"}," |"),r.a.createElement(s.c,{to:"/search",className:"header-link"},"Search"),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"divider"}," |"),r.a.createElement(s.c,{to:"/create",className:"header-link"},"Submit"))),r.a.createElement("div",{className:"flex"},t?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header-name"},t.displayName),r.a.createElement("div",{className:"divider"}," |"),r.a.createElement("div",{className:"header-button",onClick:function(){return a.logout()}},"Log Out")):r.a.createElement(s.c,{to:"/login",className:"header-link"},"Log In")))}),Z=function(){var e=Object(n.useState)(null),t=Object(f.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)(function(){var e=N.auth.onAuthStateChanged(function(e){r(e||null)});return function(){return e()}},[]),a};var z=function(){var e=Z();return r.a.createElement(s.a,null,r.a.createElement(v.Provider,{value:{currentUser:e,firebase:N}},r.a.createElement("div",{className:"app-container"},r.a.createElement(W,null),r.a.createElement("div",{className:"route-container"},r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/",exact:!0,render:function(){return r.a.createElement(i.a,{to:"/new/1"})}}),r.a.createElement(i.b,{path:"/create",component:g}),r.a.createElement(i.b,{path:"/login",component:C}),r.a.createElement(i.b,{path:"/forgot",component:S}),r.a.createElement(i.b,{path:"/search",component:U}),r.a.createElement(i.b,{path:"/top",component:F}),r.a.createElement(i.b,{path:"/new/:page",component:F}),r.a.createElement(i.b,{path:"/link/:linkId",component:H}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[39,1,2]]]);
//# sourceMappingURL=main.ac2909d3.chunk.js.map